(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,function(t,e,i){t.exports=i(17)},,,,,,function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var a=i(0),s=i.n(a),r=i(7),n=i.n(r),o=(i(14),i(1)),h=i(2),c=i(4),l=i(3),u=i(5);i(15);function d(t){return 4095&t}function v(t){return 255&t}function y(t){return 15&t}function f(t){return(3840&t)>>8}function m(t){return(240&t)>>4}var p=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128],C=function(){function t(e){Object(o.a)(this,t),e=e||{},this.MEM_SIZE=e.memSize||4096,this.PC_START=e.pcStart||512,this.STACK_SIZE=e.stackSize||16,this.DISPLAY_SIZE=e.displaySize||2048,this.screen={draw:function(t){}},this.reset()}return Object(h.a)(t,[{key:"reset",value:function(){var t=this;this.memory=new Uint8Array(this.MEM_SIZE),p.forEach(function(e,i){t.memory[i]=e}),this.V=new Uint8Array(16),this.I=0,this.DT=0,this.ST=0,this.PC=this.PC_START,this.SP=0,this.stack=new Uint16Array(this.STACK_SIZE),this.display=new Array(this.DISPLAY_SIZE).fill(0),this.keys={},this.waitingKey=!1,this.waitingKeyTarget=-1,this.screen.draw(this.display)}},{key:"pressKey",value:function(t){this.keys[15&t]=!0,this.waitingKey&&(this.V[this.waitingKeyTarget]=t,this.waitingKey=!1)}},{key:"releaseKey",value:function(t){this.keys[15&t]=!1}},{key:"delayTimerTick",value:function(){this.DT>0&&(this.DT-=1)}},{key:"soundTimerTick",value:function(){this.ST>0&&(this.ST-=1),this.ST&&console.log("Stop sound!")}},{key:"writeWord",value:function(t,e){return this.writeByte(t,e>>8&255),this.writeByte(t+1,255&e),this}},{key:"writeByte",value:function(t,e){this.memory[t]=e}},{key:"cycle",value:function(){if(!this.waitingKey){var t=this.memory[this.PC]<<8|this.memory[this.PC+1];this.executeOpCode(t),this.shouldDraw&&(this.shouldDraw=!1,this.screen.draw(this.display))}}},{key:"throwInvalidOpCode",value:function(t){throw new Error("Invalid instruction opCode=".concat(t.toString(16)))}},{key:"executeOpCode",value:function(t){switch(this.PC+=2,(61440&t)>>12){case 0:return void this.opCodeFamily_0x0(t);case 1:return void this.opCodeFamily_0x1(t);case 2:return void this.opCodeFamily_0x2(t);case 3:return void this.opCodeFamily_0x3(t);case 4:return void this.opCodeFamily_0x4(t);case 5:return void this.opCodeFamily_0x5(t);case 6:return void this.opCodeFamily_0x6(t);case 7:return void this.opCodeFamily_0x7(t);case 8:return void this.opCodeFamily_0x8(t);case 9:return void this.opCodeFamily_0x9(t);case 10:return void this.opCodeFamily_0xA(t);case 11:return void this.opCodeFamily_0xB(t);case 12:return void this.opCodeFamily_0xC(t);case 13:return void this.opCodeFamily_0xD(t);case 14:return void this.opCodeFamily_0xE(t);case 15:return void this.opCodeFamily_0xF(t);default:return void this.throwInvalidOpCode(t)}}},{key:"opCodeFamily_0x0",value:function(t){switch(t){case 224:this.display.fill(0);break;case 238:this.SP-=1,this.PC=this.stack[this.SP]}}},{key:"opCodeFamily_0x1",value:function(t){var e=d(t);this.PC=e}},{key:"opCodeFamily_0x2",value:function(t){var e=d(t);this.stack[this.SP]=this.PC,this.SP+=1,this.PC=e}},{key:"opCodeFamily_0x3",value:function(t){var e=f(t),i=v(t);this.V[e]===i&&(this.PC+=2)}},{key:"opCodeFamily_0x4",value:function(t){var e=f(t),i=v(t);this.V[e]!==i&&(this.PC+=2)}},{key:"opCodeFamily_0x5",value:function(t){var e=f(t),i=m(t);0!==y(t)&&this.throwInvalidOpCode(t),this.V[e]===this.V[i]&&(this.PC+=2)}},{key:"opCodeFamily_0x6",value:function(t){var e=f(t),i=v(t);this.V[e]=i}},{key:"opCodeFamily_0x7",value:function(t){var e=f(t),i=v(t);this.V[e]=this.V[e]+i&255}},{key:"opCodeFamily_0x8",value:function(t){var e=y(t),i=f(t),a=m(t);switch(e){case 0:this.V[i]=this.V[a];break;case 1:this.V[i]=this.V[i]|this.V[a];break;case 2:this.V[i]=this.V[i]&this.V[a];break;case 3:this.V[i]=this.V[i]^this.V[a];break;case 4:var s=this.V[i]+this.V[a];this.V[15]=s>255,this.V[i]=255&s;break;case 5:var r=this.V[i]-this.V[a];this.V[15]=this.V[i]>=this.V[a],this.V[i]=255&r;break;case 6:this.V[15]=1&this.V[a],this.V[i]=this.V[a]=this.V[a]>>1;break;case 7:var n=this.V[a]-this.V[i];this.V[15]=this.V[a]>=this.V[i],this.V[i]=255&n;break;case 14:this.V[15]=(128&this.V[a])>>7,this.V[i]=this.V[a]=this.V[a]<<1;break;default:return void this.throwInvalidOpCode(t)}}},{key:"opCodeFamily_0x9",value:function(t){var e=f(t),i=m(t);0!==y(t)&&this.throwInvalidOpCode(t),this.V[e]!==this.V[i]&&(this.PC+=2)}},{key:"opCodeFamily_0xA",value:function(t){var e=d(t);this.I=e}},{key:"opCodeFamily_0xB",value:function(t){var e=d(t);this.PC=e+this.V[0]}},{key:"opCodeFamily_0xC",value:function(t){var e=f(t),i=v(t);this.V[e]=256*Math.random()&i}},{key:"opCodeFamily_0xD",value:function(t){var e=f(t),i=m(t),a=y(t);this.shouldDraw=!0,this.V[15]=0;for(var s=0;s<a;s++)for(var r=this.memory[this.I+s],n=0;n<8;n++){if(r&128>>n){var o=(this.V[e]+n)%64+64*((this.V[i]+s)%32);0!==this.display[o]&&(this.V[15]=1),this.display[o]^=1}}}},{key:"opCodeFamily_0xE",value:function(t){var e=f(t);switch(v(t)){case 158:var i=this.V[e];this.keys[i]&&(this.PC+=2);break;case 161:var a=this.V[e];this.keys[a]||(this.PC+=2);break;default:return void this.throwInvalidOpCode(t)}}},{key:"opCodeFamily_0xF",value:function(t){var e=f(t);switch(v(t)){case 7:this.V[e]=this.DT;break;case 10:this.waitingKey=!0,this.waitingKeyTarget=e;break;case 21:this.DT=this.V[e];break;case 24:this.ST=this.V[e];break;case 30:this.I=this.I+this.V[e]&65535;break;case 41:this.I=5*(15&this.V[e]);break;case 51:this.memory[this.I]=Math.floor(this.V[e]/100)%10,this.memory[this.I+1]=Math.floor(this.V[e]/10)%10,this.memory[this.I+2]=this.V[e]%10;break;case 85:for(var i=0;i<=e;i++)this.memory[this.I]=this.V[i],this.I=this.I+1&65535;break;case 101:for(var a=0;a<=e;a++)this.V[a]=this.memory[this.I],this.I=this.I+1&65535;break;default:return void this.throwInvalidOpCode(t)}}}]),t}(),k=(i(16),function(t){function e(t){var i;return Object(o.a)(this,e),(i=Object(c.a)(this,Object(l.a)(e).call(this,t))).containerRef=s.a.createRef(),i.canvasRef=s.a.createRef(),i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"resizeCanvas",value:function(){var t=this.containerRef.current.offsetWidth,e=this.containerRef.current.offsetHeight,i=Math.floor(Math.min(t/64,e/32));this.canvasWidth=this.canvasRef.current.width=64*i,this.canvasHeight=this.canvasRef.current.height=32*i}},{key:"draw",value:function(){this.ctx.fillStyle=this.rgbFromColor(this.props.backgroundColor),this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight);var t=this.canvasHeight/32;this.ctx.fillStyle=this.rgbFromColor(this.props.drawColor);for(var e=this.props.displayData,i=0;i<e.length;i++){var a=Math.floor(i/64),s=i%64;if(0!==e[i]){var r=s*t,n=a*t;this.ctx.fillRect(r,n,t,t)}}this.requestFrameId=window.requestAnimationFrame(this.draw.bind(this))}},{key:"rgbFromColor",value:function(t){return"rgb(".concat(t.r,",").concat(t.g,",").concat(t.b,")")}},{key:"componentDidMount",value:function(){this.ctx=this.canvasRef.current.getContext("2d"),this.canvasWidth=this.canvasRef.current.width,this.canvasHeight=this.canvasRef.current.height,this.resizeCanvas(),this.requestFrameId=window.requestAnimationFrame(this.draw.bind(this)),window.addEventListener("resize",this.resizeCanvas.bind(this))}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.requestFrameId),window.removeEventListener("resize",this.resizeCanvas.bind(this))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return s.a.createElement("section",{ref:this.containerRef,className:"ScreenContainer"},s.a.createElement("canvas",{ref:this.canvasRef,className:"ScreenCanvas"}))}}]),e}(s.a.Component));k.defaultProps={backgroundColor:{r:40,g:40,b:40},drawColor:{r:102,g:255,b:102},displayData:new Array(2048).fill(0)};var w=k,V=function(t){function e(t){var i;return Object(o.a)(this,e),(i=Object(c.a)(this,Object(l.a)(e).call(this,t))).handleFile=function(t){t.preventDefault();var e=t.target.files[0],a=new FileReader;a.onload=function(t){var e=t.target.result;i.rom=new Uint8Array(e)},a.readAsArrayBuffer(e)},i.handleStart=function(t){t.preventDefault(),i.intervalHandle&&clearInterval(i.intervalHandle),i.chip8.reset();var e=512;console.log("Rom size ".concat(i.rom.length)),i.rom.forEach(function(t){i.chip8.writeByte(e,t),e++});i.intervalHandle=setInterval(function(){var t=i.cyclesPerTick;do{i.chip8.cycle(),t--}while(t>0);i.setState({displayData:i.chip8.display}),i.chip8.soundTimerTick(),i.chip8.delayTimerTick()},1e3/60)},i.state={displayData:new Array(0).fill(0)},i.myRef=s.a.createRef(),i.intervalHandle=null,i.cyclesPerTick=10,i.rom=[],i.chip8=new C,i}return Object(u.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement("input",{type:"file",id:"file",onChange:this.handleFile}),s.a.createElement("button",{id:"start",onClick:this.handleStart},"Start!"),s.a.createElement(w,{displayData:this.state.displayData}))}}]),e}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(s.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[8,1,2]]]);
//# sourceMappingURL=main.cb77add9.chunk.js.map